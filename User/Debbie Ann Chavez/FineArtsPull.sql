
SELECT 
COUNT(*), GRADE
FROM 
(
SELECT DISTINCT BS.SIS_NUMBER, GRADE
	/*
	SCHOOL_NAME, LAST_NAME, FIRST_NAME, BS.SIS_NUMBER, PRIM.GRADE
	,SCH.COURSE_ID, SCH.COURSE_TITLE, SCH.TERM_CODE
	--,HIST.MARK AS CRS_HIST_MARK
	*/
	
 FROM 
APS.PrimaryEnrollmentDetailsAsOf(GETDATE()) AS PRIM
INNER JOIN 
APS.BasicStudentWithMoreInfo AS BS
ON
PRIM.STUDENT_GU = BS.STUDENT_GU
INNER JOIN 
APS.ScheduleDetailsAsOf(GETDATE()) AS SCH
ON
BS.STUDENT_GU = SCH.STUDENT_GU
/*
LEFT JOIN 
rev.EPC_STU_CRS_HIS AS HIST
ON
HIST.STUDENT_GU = BS.STUDENT_GU 
*/



WHERE
--PRIM.GRADE = '06'
--AND 
SCH.COURSE_ID IN (
 '239a1', 
 '70901', 
 '70901de', 
 '70902', 
 '70902de', 
 '70903de', 
 '70906', 
 '7090y', 
 '709b1', 
 '709b2', 
 '72600', 
 '72602', 
 '72603', 
 '72603de', 
 '72604de', 
 '72605de', 
 '72700', 
 '72901', 
 '72903', 
 '72904', 
 '7290y', 
 '73004', 
 '73005', 
 '73006', 
 '73007', 
 '73008', 
 '73009', 
 '73504', 
 '73505', 
 '73506', 
 '735a1', 
 '735a2', 
 '735a3', 
 '74004', 
 '74005', 
 '74006', 
 '74904', 
 '74905', 
 '75000', 
 '75001', 
 '75002', 
 '75003', 
 '75004')

) AS T1

 GROUP BY GRADE
 --ORDER BY SCHOOL_NAME, LAST_NAME, FIRST_NAME