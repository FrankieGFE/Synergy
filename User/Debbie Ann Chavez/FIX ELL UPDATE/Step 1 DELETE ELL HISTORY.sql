
--SELECT COUNT (*) FROM REV.EPC_STU_PGM_ELL_HIS


BEGIN TRANSACTION

DELETE  REV.EPC_STU_PGM_ELL_HIS


/*
FROM (
	
	--SKIP 17 STUDENTS THAT NEVER HAD AN INITIAL SCREENING
	--CHRISTOPH SAYS THESE ARE OKAY TO SKIP
	SELECT OLD.SIS_NUMBER, WTF.* FROM 
	(
	SELECT DISTINCT
	HIST.STUDENT_GU,SIS_NUMBER FROM 
	rev.EPC_STU_PGM_ELL_HIS AS HIST
	INNER JOIN 
	REV.EPC_STU AS STU
	ON
	HIST.STUDENT_GU = STU.STUDENT_GU
	) AS OLD

	LEFT JOIN 
	(SELECT STUDENT_GU FROM 
	APS.LCEFirstEvaluationAsOf('20170814') AS GETELL
	WHERE IS_ELL = 1
	) AS NEW
	ON
	NEW.STUDENT_GU = OLD.STUDENT_GU

	LEFT JOIN 
	(SELECT STUDENT_GU, TEST_NAME, ADMIN_DATE, PERFORMANCE_LEVEL FROM 
	APS.LCEFirstEvaluationAsOf('20170814') AS GETELL
	) AS WTF
	ON
	WTF.STUDENT_GU = OLD.STUDENT_GU

	WHERE
	NEW.STUDENT_GU IS NULL
	AND TEST_NAME NOT IN  ('WAPT', 'PRE-LAS', 'SCREENER')

) AS T1
*/

WHERE

STUDENT_GU NOT IN (

'54E51317-CE14-4B6C-A4E7-1320928AF94B',
'76BDE6B5-C7E7-49EE-8E62-1AC46DD2B93C',
'90C1C6AE-9A3E-44C0-B797-3A92147C3E4C',
'FB0AB76E-2D42-4A04-8AC7-4B9DC48A5B08',
'39C09E71-62F1-42DB-98EA-31E8C41EA391',
'2599688C-2109-4FFA-8543-2DE47D61D02C',
'F953E8A8-3FDA-46F4-AB4B-9AC03D7FC879',
'EAE64CEB-CEE4-47EF-AB54-A0345DD4C9B9',
'89F08D7D-D7A4-45E2-A774-8824E4D59E78',
'72E077E3-06CD-4283-B46F-5F7A97028AAF',
'7716801D-0247-4745-8DA1-763CE769535E',
'1BBAB03D-8EB5-464C-8E83-7E95A550614E',
'ECE0EB1D-D580-42AB-BEAF-8A76DBF2D7FE',
'2913464E-414F-4252-9C19-CFC3BDF41280',
'EB3803D1-8DE3-4342-AD94-EF20435A4585',
'DC6B2FC1-B2F1-4552-AC31-BAD0D7286AA9',
'AB8F161A-4B7E-4C37-B1D0-D91ADE8E5C57'
)


--T1.STUDENT_GU != REV.EPC_STU_PGM_ELL_HIS.STUDENT_GU

COMMIT

