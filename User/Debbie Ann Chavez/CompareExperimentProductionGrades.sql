

SELECT * FROM

(
SELECT 
PRODUCTION.SCHOOLYEAR
,CURRENTLY_ENROLLED
,PRODUCTION.ORGANIZATION_NAME
,PRODUCTION.SIS_NUMBER
,PRODUCTION.STUDENT_LAST_NAME
,PRODUCTION.STUDENT_FIRST_NAME
,PRODUCTION.GRADE

,PRODUCTION.COURSE_ID
,PRODUCTION.SECTION_ID
, PRODUCTION.COURSE_TITLE
,PRODUCTION.TEACHER_AIDE

,PRODUCTION.TEACHER_LAST_NAME
,PRODUCTION.TEACHER_FIRST_NAME
,PRODUCTION.EMAIL

,PRODUCTION.PERIOD

,EXPERIMENT.GRADE_AS_OF_JAN9TH
,EXPERIMENT.VALUE AS [9VALUE]
,PRODUCTION.GRADE_AS_OF_JAN9TH AS GRADE_AS_OF_JAN16TH
,PRODUCTION.VALUE AS [16VALUE]

,CASE WHEN EXPERIMENT.VALUE >  PRODUCTION.VALUE  THEN 'X' ELSE '' END AS GRADE_WENT_DOWN
,CASE WHEN EXPERIMENT.VALUE <  PRODUCTION.VALUE  THEN 'X' ELSE '' END AS GRADE_WENT_UP
,CASE WHEN 
	EXPERIMENT.PERIOD IN ('1st 6 Wk', '2nd 6 Wk',  '1st 6 Wks','Q1', 'Q2') 
	AND EXPERIMENT.GRADE_AS_OF_JAN9TH IN ('D+', 'D', 'D-') 
	AND PRODUCTION.GRADE_AS_OF_JAN9TH = 'F' THEN 'X' ELSE '' END AS D_TO_F_IN_FIRST2PERIODS

FROM

dbo.ExperimentGrades AS EXPERIMENT
INNER HASH JOIN
dbo.ProductionGrades AS PRODUCTION
ON
  EXPERIMENT.PERSON_GU = PRODUCTION.PERSON_GU
  AND EXPERIMENT.SECTION_GU = PRODUCTION.SECTION_GU
  AND EXPERIMENT.PERIOD = PRODUCTION.PERIOD
  AND EXPERIMENT.GRADE_AS_OF_JAN9TH != PRODUCTION.GRADE_AS_OF_JAN9TH
  
  ) AS T3
  

  --WHERE CURRENTLY_ENROLLED = 'Active'
   
ORDER BY 
ORGANIZATION_NAME
,TEACHER_LAST_NAME
,TEACHER_FIRST_NAME
,STUDENT_LAST_NAME
,STUDENT_FIRST_NAME
,PERIOD
