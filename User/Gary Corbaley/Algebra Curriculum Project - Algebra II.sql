




SELECT
	[ENROLLMENT].[SCHOOL_YEAR] + 1 AS [SCHOOL_YEAR]
	,[STUDENT].[SIS_NUMBER]
	,[STUDENT].[STATE_STUDENT_NUMBER]
	,[STUDENT].[FIRST_NAME]
	,[STUDENT].[LAST_NAME]
	,[STUDENT].[BIRTH_DATE]
	,[ENROLLMENT].[SCHOOL_CODE]
	,[ENROLLMENT].[SCHOOL_NAME]
	,[ENROLLMENT].[GRADE] AS [GRADE_LEVEL]
	,[SCHEDULE].[COURSE_TITLE]
	,[SCHEDULE].[COURSE_ID]
	,[SCHEDULE].[TERM_CODE]
	,[HISTORY].[MARK] AS [GRADE]
	,REPLACE([STAFF].[BADGE_NUM],'e','') AS [TEACHER_ID]
	,[STAFF_PERSON].[FIRST_NAME] + ' ' + [STAFF_PERSON].[LAST_NAME] AS [TEACHER_NAME]
	
FROM
	APS.ScheduleForYeaR('26F066A3-ABFC-4EDB-B397-43412EDABC8B') AS [SCHEDULE]
	
	LEFT OUTER JOIN
	rev.EPC_STU_CRS_HIS AS [HISTORY]
	ON
	[SCHEDULE].[STUDENT_GU] = [HISTORY].[STUDENT_GU]
	AND [SCHEDULE].[COURSE_GU] = [HISTORY].[COURSE_GU]
	AND [SCHEDULE].[TERM_CODE] = [HISTORY].[TERM_CODE]
	AND [HISTORY].[SCHOOL_YEAR] = '2014'
	
	INNER JOIN
	APS.StudentEnrollmentDetails AS [ENROLLMENT]
	ON
	[SCHEDULE].[STUDENT_GU] = [ENROLLMENT].[STUDENT_GU]
	AND [SCHEDULE].[ORGANIZATION_YEAR_GU] = [ENROLLMENT].[ORGANIZATION_YEAR_GU]
	
	INNER JOIN
	APS.BasicStudent AS [STUDENT]
	ON
	[SCHEDULE].[STUDENT_GU] = [STUDENT].[STUDENT_GU]
	
	LEFT OUTER JOIN
	rev.[EPC_STAFF] AS [STAFF]
	ON
	[SCHEDULE].[STAFF_GU] = [STAFF].[STAFF_GU]
	
	LEFT OUTER JOIN
	rev.REV_PERSON AS [STAFF_PERSON]
	ON
	[SCHEDULE].[STAFF_GU] = [STAFF_PERSON].[PERSON_GU]
	
WHERE
--	[ENROLLMENT].[SCHOOL_YEAR] = '2014'
--	AND [ENROLLMENT].[EXTENSION] = 'R'
	[SCHEDULE].[COURSE_LEAVE_DATE] IS NOT NULL
	AND	[SCHEDULE].[COURSE_ID] IN
	
('3603B1',
'3603B2',
'36040DI2',
'360401',
'360402',
'360403',
'062C21',
'062C22',
'36040C',
'36040C1',
'36040C2',
'36040DE1',
'36040DE2',
'3604A1',
'3604A2',
'360350',
'360351',
'360352',
'3603500',
'060C71',
'060C72',
'061C71',
'061C72',
'062D11',
'062D12',
'36035DE1',
'36035DE2',
'360801',
'360802',
'MATH421',
'MATH2810',
'MATH312')