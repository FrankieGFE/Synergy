



SELECT
	--[ENROLLMENT].*
	[STUDENT].[SIS_NUMBER]
	,[STUDENT].[FIRST_NAME]
	,[STUDENT].[LAST_NAME]
	,[STUDENT].[MIDDLE_NAME]
	,[ENROLLMENT].[SCHOOL_CODE]
	,[ENROLLMENT].[SCHOOL_NAME]
	,[ENROLLMENT].[ENTER_DATE]
	,[ENROLLMENT].[LEAVE_DATE]
	,[ENROLLMENT].[SUMMER_WITHDRAWL_CODE]
	,[SCHEDULE].[COURSE_ID]
	,[SCHEDULE].[COURSE_TITLE]
	,[SCHEDULE].[SECTION_ID]
	,[SCHEDULE].[TEACHER NAME]
	,[SCHEDULE].[COURSE_ENTER_DATE]
	,[SCHEDULE].[COURSE_LEAVE_DATE]
	
FROM
	APS.StudentEnrollmentDetails AS [ENROLLMENT]
	
	INNER JOIN
	APS.ScheduleDetailsAsOf(GETDATE()) AS [SCHEDULE]
	ON
	[ENROLLMENT].[STUDENT_GU] = [SCHEDULE].[STUDENT_GU]
	AND [ENROLLMENT].[ORGANIZATION_YEAR_GU] = [SCHEDULE].[ORGANIZATION_YEAR_GU]
	
	INNER JOIN
	APS.BasicStudent AS [STUDENT]
	ON
	[ENROLLMENT].[STUDENT_GU] = [STUDENT].[STUDENT_GU]
	
WHERE
	[ENROLLMENT].[SCHOOL_YEAR] = '2015'
	AND [ENROLLMENT].[EXTENSION] = 'R'
	AND (
	[ENROLLMENT].[LEAVE_DATE] IS NOT NULL
	OR ([ENROLLMENT].[SUMMER_WITHDRAWL_CODE] IS NOT NULL AND [ENROLLMENT].[ENTER_DATE] IS NULL)
	)
	--AND [STUDENT].[SIS_NUMBER] = '970088981'