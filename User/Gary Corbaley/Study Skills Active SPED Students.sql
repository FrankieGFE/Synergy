



SELECT
	[STUDENT].[SIS_NUMBER]
	,[STUDENT].[STATE_STUDENT_NUMBER]
	,[STUDENT].[FIRST_NAME]
	,[STUDENT].[LAST_NAME]
	,[STUDENT].[MIDDLE_NAME]
	,[ENROLLMENTS].[GRADE]
	,[ENROLLMENTS].[SCHOOL_CODE]
	,[ENROLLMENTS].[SCHOOL_NAME]
	,[STUDENT].[SPED_STATUS]
	,[SCHEDULE].[COURSE_ID]
	,[SCHEDULE].[COURSE_TITLE]
	,[SCHEDULE].[SECTION_ID]
	
FROM
	APS.ScheduleAsOf(GETDATE()) AS [SCHEDULE]
	
	INNER JOIN
	(
	SELECT
		*
		,ROW_NUMBER() OVER (PARTITION BY [STUDENT_GU] ORDER BY [ENTER_DATE] DESC) AS RN
	FROM
		APS.StudentEnrollmentDetails
		
	WHERE
		SCHOOL_YEAR = 2015
		AND EXTENSION = 'R'
		AND EXCLUDE_ADA_ADM IS NULL
		
	) AS [ENROLLMENTS]
	ON
	[SCHEDULE].[STUDENT_GU] = [ENROLLMENTS].[STUDENT_GU]
	AND [ENROLLMENTS].[RN] = 1
	
	INNER JOIN
	APS.BasicStudentWithMoreInfo AS [STUDENT]
	ON
	[SCHEDULE].[STUDENT_GU] = [STUDENT].[STUDENT_GU]
	
	
WHERE
	[ENROLLMENTS].[GRADE] IN ('09','10','11','12','C1','C2','C3','C4','T1','T2','T3','T4')	
	AND [SCHEDULE].[COURSE_ID] IN
	('0600e1',
	'0600e2',
	'0600f1',
	'0600f2',
	'0600g1',
	'0600g2',
	'0600h1',
	'0600h2',
	'0610e2',
	'0610e1',
	'0610f1',
	'0610f2',
	'0610g1',
	'0610g2',
	'0610h1',
	'0610h2',
	'0620e1',
	'0620e2',
	'0620f1',
	'0620f2',
	'0620g1',
	'0620g2',
	'0620h1',
	'0620h2',
	'0708a',
	'0708a1',
	'0708a2',
	'0708b',
	'0708c',
	'0708d',
	'0708e',
	'0718a',
	'0718b',
	'0718c',
	'53000')
