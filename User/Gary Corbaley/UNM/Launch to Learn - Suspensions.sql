



SELECT DISTINCT
	[ENROLLMENTS].[SCHOOL_YEAR]
	,[STUDENT].[SIS_NUMBER]
	,[STUDENT].[STATE_STUDENT_NUMBER]
	--,[STUDENT].[FIRST_NAME]
	--,[STUDENT].[LAST_NAME]
	--,[STUDENT].[MIDDLE_NAME]
	--,[ENROLLMENTS].[SCHOOL_CODE]
	--,[ENROLLMENTS].[SCHOOL_NAME]
	,[ENROLLMENTS].[GRADE]
	--,[ENROLLMENTS_2013].[SCHOOL_CODE]
	--,[ENROLLMENTS_2013].[SCHOOL_NAME]
	--,[STUDENT].[BIRTH_DATE]
	--,[STUDENT].[RESOLVED_RACE]
	--,[STUDENT].[GENDER]
	--,[STUDENT].[LUNCH_STATUS]
	--,[STUDENT].[ELL_STATUS]
	--,[STUDENT].[SPED_STATUS]
	
	--,[DAILY_ATT].[Half-Day Unexcused] AS [Half-Day Unexcused PRIMARY]
	--,[DAILY_ATT].[Full-Day Unexcused] AS [Full-Day Unexcused PRIMARY]
	--,[DAILY_ATT].[Full-Day Excused] AS [Full-Day Excused PRIMARY]
	
	--,[PERIOD_ATT].[Full Days Unexcused] AS [Full Days Unexcused SECONDARY]
	--,[PERIOD_ATT].[Half Days Unexcused] AS [Half Days Unexcused SECONDARY]
	
	--,[ENROLLMENTS_SUMMER].[SCHOOL_NAME] AS [SUMMER_SCHOOL]
	--,[ENROLLMENTS_SUMMER].[ENTER_DATE] AS [SUMMER_START]
	--,[ENROLLMENTS_SUMMER].[LEAVE_DATE] AS [SUMMER_END]
	
	,[DISCIPLINE].[SUSPENSION_DAYS]
	
FROM
	(
	SELECT
		*
		,ROW_NUMBER() OVER (PARTITION BY [ENR].[STUDENT_GU] ORDER BY [ENR].[ENTER_DATE] DESC) AS [RN]
	FROM
		APS.StudentEnrollmentDetails AS [ENR]
		
	WHERE
		[ENR].SCHOOL_YEAR = '2014'
		AND [ENR].[EXTENSION] = 'R'
		AND [ENR].[EXCLUDE_ADA_ADM] IS NULL
		AND [ENR].[SUMMER_WITHDRAWL_CODE] IS NULL
	) AS [ENROLLMENTS]
	
	LEFT OUTER JOIN
	(
	SELECT
		*
		,ROW_NUMBER() OVER (PARTITION BY [ENR].[STUDENT_GU] ORDER BY [ENR].[ENTER_DATE] DESC) AS [RN]
	FROM
		APS.StudentEnrollmentDetails AS [ENR]
		
	WHERE
		[ENR].SCHOOL_YEAR = '2015'
		AND [ENR].[EXTENSION] = 'N'
		AND [ENR].[EXCLUDE_ADA_ADM] IS NULL
		AND [ENR].[SUMMER_WITHDRAWL_CODE] IS NULL
	) AS [ENROLLMENTS_SUMMER]
	ON
	[ENROLLMENTS].[STUDENT_GU] = [ENROLLMENTS_SUMMER].[STUDENT_GU]	
	
	INNER JOIN
	APS.BasicStudentWithMoreInfo AS [STUDENT]
	ON
	[ENROLLMENTS].[STUDENT_GU] = [STUDENT].[STUDENT_GU]
	
	--LEFT OUTER JOIN
	--APS.DailyAttendanceAsOf('05/22/2015') AS [DAILY_ATT]
	--ON
	--[STUDENT].[SIS_NUMBER] = [DAILY_ATT].[SIS_NUMBER]
	
	--LEFT OUTER JOIN
	--APS.PeriodUnexcusedAsOf('05/22/2015') AS [PERIOD_ATT]
	--ON
	--[STUDENT].[SIS_NUMBER] = [PERIOD_ATT].[SIS_NUMBER]
	
	LEFT OUTER JOIN
	(
	SELECT
		[Discipline].[STUDENT_SCHOOL_YEAR_GU]
		--,[INCIDENT].[INCIDENT_DATE]
		--,[INCIDENT].[INCIDENT_ID]
		
		--,[Disposition].[DISPOSITION_DATE]
		--,[Disposition].[DISPOSITION_ID]
		,SUM([Discipline].[DAYS]) AS [SUSPENSION_DAYS]
		--,[Disposition_Code].[DISP_CODE]
		--,[Disposition_Code].[DESCRIPTION] AS [DISPOSITION_DESCRIPTION]
	FROM
		
		[rev].[EPC_STU_INC_DISCIPLINE] AS [Discipline]
		
		LEFT OUTER JOIN
		rev.EPC_SCH_INCIDENT AS [INCIDENT]
		ON
		[Discipline].[SCH_INCIDENT_GU] = [INCIDENT].[SCH_INCIDENT_GU]
	    
		LEFT OUTER JOIN
		[rev].[EPC_STU_INC_DISPOSITION] AS [Disposition]
		ON
		[Discipline].[STU_INC_DISPOSITION_GU] = [Disposition].[STU_INC_DISPOSITION_GU]
	    
		LEFT OUTER JOIN
		[rev].[EPC_CODE_DISP] AS [Disposition_Code]
		ON
		[Disposition].[CODE_DISP_GU] = [Disposition_Code].[CODE_DISP_GU]
		
	WHERE
		[Disposition_Code].[DISP_CODE] IN ('S OSS','S ISS', 'S BUS', 'S EXTRA',  'ZH504LTS', 'ZHLTSCON', 'ZHLTSCV', 'ZHLTSNRS', 'ZHLTSOTH', 'ZHLTSVQP', 'ZHSPLTS', 'EXPEL', 'ZH504EXP', 'ZHSPEXP', 'ZHEXP1YR')
		
	GROUP BY
		[Discipline].[STUDENT_SCHOOL_YEAR_GU]
	) AS [DISCIPLINE]
	ON
	[ENROLLMENTS].[STUDENT_SCHOOL_YEAR_GU] = [DISCIPLINE].[STUDENT_SCHOOL_YEAR_GU]
	
	
WHERE
	[ENROLLMENTS].[RN] = 1
	AND [STUDENT].[SIS_NUMBER] IN 
	('970002843', 
	'970020499', 
	'970027368', 
	'970029084', 
	'970036154', 
	'970040466', 
	'970040476', 
	'970040855', 
	'970042864', 
	'970043028', 
	'970043028', 
	'970043357', 
	'970046811', 
	'970047783', 
	'970047828', 
	'970047876', 
	'970048647', 
	'970050269', 
	'970051569', 
	'970053100', 
	'970055403', 
	'970055468', 
	'970055510', 
	'970055592', 
	'970055698', 
	'970055700', 
	'970056081', 
	'970056747', 
	'970057031', 
	'970057043', 
	'970057158', 
	'970057372', 
	'970057673', 
	'970057731', 
	'970057909', 
	'970057910', 
	'970058331', 
	'970058542', 
	'970059554', 
	'970060094', 
	'970061354', 
	'970062000', 
	'970062494', 
	'970062547', 
	'970062572', 
	'970062593', 
	'970063438', 
	'970063498', 
	'970064278', 
	'970064723', 
	'970064802', 
	'970065264', 
	'970065824', 
	'970066727', 
	'970067532', 
	'970067547', 
	'970067585', 
	'970067778', 
	'970067781', 
	'970068293', 
	'970068425', 
	'970069650', 
	'970069689', 
	'970070052', 
	'970070432', 
	'970070649', 
	'970071041', 
	'970071261', 
	'970071382', 
	'970071465', 
	'970071684', 
	'970071716', 
	'970071775', 
	'970071881', 
	'970071899', 
	'970072020', 
	'970072252', 
	'970072705', 
	'970072711', 
	'970073056', 
	'970073244', 
	'970073668', 
	'970073984', 
	'970075300', 
	'970075634', 
	'970076541', 
	'970076833', 
	'970076861', 
	'970077636', 
	'970078073', 
	'970078143', 
	'970078446', 
	'970079445', 
	'970079784', 
	'970080702', 
	'970080884', 
	'970081179', 
	'970081397', 
	'970081479', 
	'970081676', 
	'970081677', 
	'970082255', 
	'970082294', 
	'970082518', 
	'970082540', 
	'970082693', 
	'970082707', 
	'970082721', 
	'970082743', 
	'970082744', 
	'970083865', 
	'970083958', 
	'970084019', 
	'970084071', 
	'970084431', 
	'970084547', 
	'970084550', 
	'970084618', 
	'970084680', 
	'970084723', 
	'970084771', 
	'970085296', 
	'970085348', 
	'970085934', 
	'970086031', 
	'970086037', 
	'970086043', 
	'970086067', 
	'970086179', 
	'970086182', 
	'970086518', 
	'970086536', 
	'970086584', 
	'970086972', 
	'970087010', 
	'970087072', 
	'970087105', 
	'970087115', 
	'970087116', 
	'970087197', 
	'970087220', 
	'970087425', 
	'970087438', 
	'970087442', 
	'970087443', 
	'970087448', 
	'970087499', 
	'970087542', 
	'970087597', 
	'970087611', 
	'970087922', 
	'970088245', 
	'970088253', 
	'970088406', 
	'970088693', 
	'970089801', 
	'970090657', 
	'970090819', 
	'970091323', 
	'970091503', 
	'970091672', 
	'970091857', 
	'970091920', 
	'970092137', 
	'970092418', 
	'970092453', 
	'970092505', 
	'970093587', 
	'970093880', 
	'970093886', 
	'970093889', 
	'970094271', 
	'970094301', 
	'970094587', 
	'970095101', 
	'970095172', 
	'970095200', 
	'970095334', 
	'970095519', 
	'970095523', 
	'970096242', 
	'970097094', 
	'970097264', 
	'970097421', 
	'970097683', 
	'970097702', 
	'970097716', 
	'970097921', 
	'970097922', 
	'970098089', 
	'970098099', 
	'970098196', 
	'970098310', 
	'970098584', 
	'970098687', 
	'970098694', 
	'970098794', 
	'970099734', 
	'970099804', 
	'970099828', 
	'970099851', 
	'970100082', 
	'970100086', 
	'970100250', 
	'970100450', 
	'970100482', 
	'970100629', 
	'970100695', 
	'970100758', 
	'970100856', 
	'970101000', 
	'970101080', 
	'970101384', 
	'970101461', 
	'970101691', 
	'970102183', 
	'970102214', 
	'970102246', 
	'970102544', 
	'970102591', 
	'970102774', 
	'970102876', 
	'970102905', 
	'970102906', 
	'970102976', 
	'970103023', 
	'970103052', 
	'970103059', 
	'970103084', 
	'970103358', 
	'970103369', 
	'970103390', 
	'970103413', 
	'970103722', 
	'970103723', 
	'970104006', 
	'970104135', 
	'970104234', 
	'970104967', 
	'970105050', 
	'970105479', 
	'970105719', 
	'970105917', 
	'970105960', 
	'970105968', 
	'970106286', 
	'970107007', 
	'970107318', 
	'970107446', 
	'970107786', 
	'970107875', 
	'970107896', 
	'970107990', 
	'970108011', 
	'970108105', 
	'970108259', 
	'970108273', 
	'970108459', 
	'970109140', 
	'970109141', 
	'970109332', 
	'970109409', 
	'970109684', 
	'970109947', 
	'970109950', 
	'970110310', 
	'970110809', 
	'970110874', 
	'970110875', 
	'970110997', 
	'970111360', 
	'970111925', 
	'970111957', 
	'970112117', 
	'970112675', 
	'970112750', 
	'970112765', 
	'970112765', 
	'970112783', 
	'970112855', 
	'970112860', 
	'970112864', 
	'970112865', 
	'970113518', 
	'970113585', 
	'970113713', 
	'970113713', 
	'970113751', 
	'970113753', 
	'970113776', 
	'970113973', 
	'980000036', 
	'980000330', 
	'980000366', 
	'980000394', 
	'980000783', 
	'980000949', 
	'980001410', 
	'980001460', 
	'980001465', 
	'980001529', 
	'980001534', 
	'980001542', 
	'980001805', 
	'980001813', 
	'980001979', 
	'980002055', 
	'980002115', 
	'980002206', 
	'980002245', 
	'980002474', 
	'980003503', 
	'980003671', 
	'980003815', 
	'980003921', 
	'980004020', 
	'980004304', 
	'980004328', 
	'980004351', 
	'980004353', 
	'980004934', 
	'980004946', 
	'980004946', 
	'980004987', 
	'980005068', 
	'980005070', 
	'980005082', 
	'980005479', 
	'980005707', 
	'980005927', 
	'980006095', 
	'980006124', 
	'980006131', 
	'980006455', 
	'980006523', 
	'980006814', 
	'980007015', 
	'980007079', 
	'980007165', 
	'980007600', 
	'980007628', 
	'980007855', 
	'980008652', 
	'980008759', 
	'980008810', 
	'980008821', 
	'980009144', 
	'980009368', 
	'980009511', 
	'980009664', 
	'980009695', 
	'980009708', 
	'980009737', 
	'980009786', 
	'980009807', 
	'980009816', 
	'980009834', 
	'980010862', 
	'980011372', 
	'980011445', 
	'980012718', 
	'980012834', 
	'980012840', 
	'980012846', 
	'980012853', 
	'980012945', 
	'980012979', 
	'980012992', 
	'980013018', 
	'980013178', 
	'980013218', 
	'980013527', 
	'980013766', 
	'980013774', 
	'980013931', 
	'980013957', 
	'980013960', 
	'980013963', 
	'980014123', 
	'980014139', 
	'980014161', 
	'980014168', 
	'980014181', 
	'980014192', 
	'980014399', 
	'980014402', 
	'980014403', 
	'980014509', 
	'980014597', 
	'980014671', 
	'980014671', 
	'980014814', 
	'980014817', 
	'980014821', 
	'980015098', 
	'980015216', 
	'980017491')