



SELECT 
	[STUDENT].[SIS_NUMBER]
	,[STUDENT].[STATE_STUDENT_NUMBER]
	,[STUDENT].[FIRST_NAME] 
	,[STUDENT].[LAST_NAME] 
	,[STUDENT].[MIDDLE_NAME]
	,[STUDENT].[CLASS_OF]
	,[STUDENT].[RESOLVED_RACE]
	,[STUDENT].[RACE_1]
	,[STUDENT].[RACE_2]
	,[STUDENT].[RACE_3]
	,[STUDENT].[RACE_4]
	,[STUDENT].[RACE_5]
	,[ENROLLMENTS].[SCHOOL_NAME] 	
	,[ENROLLMENTS].[SCHOOL_CODE]
	,[ENROLLMENTS].[GRADE]
	
	,[COURSE].[COURSE_ID]
	,[COURSE].[COURSE_TITLE]
	,[SCHEDULE].[SECTION_ID]
	--,[SCHEDULE].[PERIOD_BEGIN]
	--,[SCHEDULE].[PERIOD_END]
	,[SCHEDULE].[TERM_CODE]
	,[STAFF_PERSON].[FIRST_NAME] +' '+ [STAFF_PERSON].[LAST_NAME] AS [TEACHER NAME]
	,REPLACE([STAFF].[BADGE_NUM],'e','') AS [BADGE_NUM]
	
FROM
	(
	SELECT
		*
		,ROW_NUMBER() OVER (PARTITION BY [STUDENT_GU], [SCHOOL_YEAR], [EXTENSION] ORDER BY [ENTER_DATE] DESC) AS RN
	FROM
		APS.StudentEnrollmentDetails
	WHERE
		SCHOOL_YEAR = 2015
		AND EXTENSION = 'R'
		AND EXCLUDE_ADA_ADM IS NULL
		AND SUMMER_WITHDRAWL_CODE IS NULL
	) AS [ENROLLMENTS]
	
	INNER JOIN
	APS.BasicStudentWithMoreInfo AS [STUDENT]
	ON
	[ENROLLMENTS].[STUDENT_GU] = [STUDENT].[STUDENT_GU]
	
	INNER JOIN
	APS.BasicSchedule AS [SCHEDULE]
	ON
	[Enrollments].[STUDENT_SCHOOL_YEAR_GU] = [SCHEDULE].[STUDENT_SCHOOL_YEAR_GU]
	
	INNER JOIN
	rev.EPC_CRS AS [COURSE]
	ON
	[SCHEDULE].[COURSE_GU] = [COURSE].[COURSE_GU]
	
	LEFT JOIN
	rev.[EPC_STAFF] AS [STAFF]
	ON
	[SCHEDULE].[STAFF_GU] = [STAFF].[STAFF_GU]

	LEFT JOIN
	rev.[REV_PERSON] AS [STAFF_PERSON]
	ON
	[STAFF].[STAFF_GU] = [STAFF_PERSON].[PERSON_GU]
	
WHERE
	([STUDENT].[RACE_1] = 'Native American' 
		OR 
	[STUDENT].[RACE_2] = 'Native American' 
		OR 
	[STUDENT].[RACE_3] = 'Native American' 
		OR 
	[STUDENT].[RACE_4] = 'Native American' 
		OR 
	[STUDENT].[RACE_5] = 'Native American')
	
	--AND [STUDENT].[SIS_NUMBER] = '103308177'
	
ORDER BY
	[ENROLLMENTS].[SCHOOL_CODE]
	,[STAFF_PERSON].[LAST_NAME]