BEGIN TRAN

TRUNCATE TABLE dbo.Employee_File

INSERT INTO 
	dbo.Employee_File

SELECT
	EMPLOYEE_ID
	,LOC_NUM
	,LOC_DESCRIPTION
	,ACCESS_CODE
	,FIRST_NAME
	,LAST_NAME
	,LAWSON_JOB_TITLE
	,JOB_TITLE_ABBREVIATION
	,[GROUP]
	,SECURITY_LVL
	,DATE_CREATE
	,BIRTHYEAR
	,EMAIL_ADDRESS
FROM
(
SELECT
	ROW_NUMBER () OVER (PARTITION BY EMPLOYEE_ID, LOC_NUM  ORDER BY DATE_ASSIGN DESC)AS RN
	--ROW_NUMBER () OVER (PARTITION BY EMPLOYEE_ID, LOC_NUM, [GROUP] ORDER BY EMPLOYEE_ID)AS RN
	,EMPLOYEE_ID
	,LOC_NUM
	,LOC_DESCRIPTION
	,ACCESS_CODE
	,FIRST_NAME
	,LAST_NAME
	,LAWSON_JOB_TITLE
	,JOB_TITLE_ABBREVIATION
	,[GROUP]
	,SECURITY_LVL
	,DATE_CREATE
	,BIRTHYEAR
	,EMAIL_ADDRESS
	,DATE_ASSIGN
FROM
	dbo.Employee_File_Temp
)AS ROWNUMBER
WHERE
	RN = '1' 
ORDER BY
	EMPLOYEE_ID
	
	

ROLLBACK