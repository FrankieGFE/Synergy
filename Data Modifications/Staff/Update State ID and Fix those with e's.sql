

BEGIN TRAN


SELECT
	[Person].[LAST_NAME]+', '+[Person].[FIRST_NAME] AS [Staff Name]
	,[BADGE_NUM]
	,[STATE_ID]
FROM
	[rev].[EPC_STAFF] AS [Staff]

	INNER JOIN
	[rev].[REV_PERSON] AS [Person]
	ON
	[Staff].[STAFF_GU]=[Person].[PERSON_GU]

WHERE
	[BADGE_NUM] IS NOT NULL
	AND ISNULL([STATE_ID],'')=''


UPDATE
	[rev].[EPC_STAFF]

	SET
		[STATE_ID]=[BADGE_NUM]

	WHERE
		[BADGE_NUM] IS NOT NULL
		AND ISNULL([STATE_ID],'')=''



SELECT
	SUBSTRING([STATE_ID],2,LEN([STATE_ID])-1)
FROM
	[rev].[EPC_STAFF]
WHERE
	LEFT([STATE_ID],1)='e'

UPDATE
	[rev].[EPC_STAFF]

	SET
	[STATE_ID]=SUBSTRING([STATE_ID],2,LEN([STATE_ID])-1)

WHERE
	LEFT([STATE_ID],1)='e'
	AND ISNUMERIC(SUBSTRING([STATE_ID],2,LEN([STATE_ID])-1))=1

	
SELECT
	*
FROM
	[rev].[EPC_STAFF]

WHERE
	LEFT([STATE_ID],1)='e'

--ROLLBACK
COMMIT