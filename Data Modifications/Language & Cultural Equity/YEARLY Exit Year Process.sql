

--EXIT YEAR PROCESS

-------------------------------------------------------------------------------------------------------
SELECT 
	SIS_NUMBER, EXIT_DATE, EXIT_REASON, LU.VALUE_DESCRIPTION AS EXIT_DESCRIPTION
FROM 
rev.EPC_STU_PGM_ELL AS ELL
INNER JOIN
rev.EPC_STU AS STU
ON
ELL.STUDENT_GU = STU.STUDENT_GU
INNER JOIN
	APS.LOOKUPTABLE ('K12.ProgramInfo', 'ELL_EXIT_REASON') AS LU
ON
LU.VALUE_CODE = ELL.EXIT_REASON

WHERE 

EXIT_DATE IS NOT NULL

ORDER BY EXIT_REASON, EXIT_DATE

-----------------------------------------------------------------------------------------------------

SELECT --PRIM.STUDENT_GU, PERFORMANCE_LEVEL, PRIM.GRADE, TEST_NAME, SCHOOL.ALT_FUNDING_SCHOOL_CODE 
	ORG.ORGANIZATION_NAME, VALUE_DESCRIPTION AS GRADE, SIS_NUMBER, LCE.ADMIN_DATE, LCE.PERFORMANCE_LEVEL, LCE.TEST_NAME
FROM 
APS.PHLOTEAsOf('2015-05-22') AS PHL
INNER JOIN
APS.PrimaryEnrollmentsAsOf('2015-05-22') AS PRIM
ON
PHL.STUDENT_GU = PRIM.STUDENT_GU
INNER JOIN
APS.LCELatestEvaluationAsOf('2015-05-22') AS LCE
ON
LCE.STUDENT_GU = PRIM.STUDENT_GU
INNER JOIN
rev.REV_ORGANIZATION_YEAR AS ORGYR
ON
ORGYR.ORGANIZATION_YEAR_GU = PRIM.ORGANIZATION_YEAR_GU
INNER JOIN
rev.EPC_SCH AS SCHOOL
ON
SCHOOL.ORGANIZATION_GU = ORGYR.ORGANIZATION_GU
INNER JOIN
rev.EPC_STU AS STU
ON
PHL.STUDENT_GU = STU.STUDENT_GU
INNER JOIN
rev.REV_ORGANIZATION AS ORG
ON
ORG.ORGANIZATION_GU = ORGYR.ORGANIZATION_GU
INNER JOIN
APS.LookupTable('K12', 'Grade') AS LU
ON
LU.VALUE_CODE = PRIM.GRADE

WHERE
	PRIM.GRADE NOT IN  ('050', '070', '090', '230', '240', '250', '260', '270', '280', '290', '300')
	AND PERFORMANCE_LEVEL IN ('ADV','BRIDG', 'FEP', 'REACH','C-PRO')

ORDER BY ORGANIZATION_NAME, SIS_NUMBER